import { 
	START, 
	SUCCESS, 
	FAILURE,
	LOAD_PRODUCTS,
	ADD_CART,
	SEARCH,
	FILTER_BRANDS,
	LOAD_PRODUCT
} from 'constans'

export function loadProduct(id){
	const linkMocky = {
		id1: 'http://www.mocky.io/v2/5acf659931000063004ea958?mocky-delay=100ms',
		id2: 'http://www.mocky.io/v2/5acf659931000063004ea958?mocky-delay=100ms',
		id3: 'http://www.mocky.io/v2/5acf659931000063004ea958?mocky-delay=100ms',
		id4: 'http://www.mocky.io/v2/5acf659931000063004ea958?mocky-delay=100ms',
		id5: 'http://www.mocky.io/v2/5acf659931000063004ea958?mocky-delay=100ms',
		id6: 'http://www.mocky.io/v2/5acf659931000063004ea958?mocky-delay=100ms'
	}
	return (dispatch) => {
		dispatch({
			type: LOAD_PRODUCT + START
		})
		console.log( linkMocky.id1 )
		fetch( 'http://www.mocky.io/v2/5acf6c2731000064004ea987' )
			.then(res => {
          if (res.status >= 400) {
              throw new Error(res.statusText)
          }
          return res.json()
      })
      .then(res =>{
      	return dispatch({
          type: LOAD_PRODUCT + SUCCESS,
          payload: res
      	})}
      )
			.catch( (err) => {
				console.log(err)
				dispatch({
					type: LOAD_PRODUCT+FAILURE
				})
			})
	}
}

export function loadCatalog(){
	return (dispatch) => {
		dispatch({
			type: LOAD_PRODUCTS+START
		})
		// http://www.mocky.io/v2/5ace4d412e00002f00c2c25a
		fetch('http://www.mocky.io/v2/5acf55573100005f004ea8df?mocky-delay=1000ms')
			.then(res => {
          if (res.status >= 400) {
              throw new Error(res.statusText)
          }
          return res.json()
      })
      .then(res =>{
      	return dispatch({
          type: LOAD_PRODUCTS + SUCCESS,
          payload: res
      	})}
      )
			.catch( (err) => {
				dispatch({
					type: LOAD_PRODUCTS+FAILURE
			})
		})
	}
}

export function addCart(price, id){
	console.log(arguments)
	return({
		type: ADD_CART,
		payload: {price, id}
	})
}

export function search(search){
	return({
		type: SEARCH,
		payload: search
	})
}

export function filterBrands(checkboxes){
	return({
		type: FILTER_BRANDS,
		payload: checkboxes
	})
}