import React, {Component} from 'react'
import {connect} from 'react-redux'
import CircularProgress from 'material-ui/CircularProgress'
import {loadProducts} from 'Actions'

class DetailedPhone extends Component{
	componentDidMount(){
		if( !this.props.loaded || !this.props.loading )
			this.props.loadProducts()
	}
	render(){
		const id = this.props.match.params.id
		const {loading, loaded, phones} = this.props
		const phone = phones[id]
		function getBody(){
			if( loading || !loaded ) 
				return <CircularProgress size={60} thickness={7} />

			return(
				<div className="b-detailed-phone">
					<div className="row">
						<div className="col-md-6">
							<div className="b-detailed-phone__img txt-c">
								<img src={phone.image} />
							</div>
						</div>
						<div className="col-md-6">
							<h1>{phone.name}</h1>
						</div>
					</div>
				</div>
			)
		}
		return(
			<div>
				<div className="container">
					<div className="row">
						<div className="col-md-9">
							{getBody()}
						</div>
						<div className="col-md-3">
							Sidebar
						</div>
					</div>
				</div>
			</div>
		)
	}
}

const mapStateToProps = (state) => {
	return({
		loading: state.loadProducts.loading,
		loaded: state.loadProducts.loaded,
		phones: state.loadProducts.phones
	})
}

const mapDispatchToProps = (dispatch) => {
	return({
		loadProducts: () => dispatch(loadProducts())
	})
}

export default connect(mapStateToProps, mapDispatchToProps)(DetailedPhone)